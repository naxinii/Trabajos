#Trabajo 04: R para Análisis Estadístico

#Regresión Lineal

#Parte 1

#Preparación de datos

#1. Librerías a utilizar

pacman::p_load(dplyr, 
               car, 
               sjmisc, 
               sjPlot, 
               sjlabelled, 
               stargazer, 
               kableExtra, 
               corrplot, 
               texreg, 
               ggplot2, 
               ggpubr)

rm(list=ls())       
options(scipen=999)

#2. Carga de la base de datos

#VARIABLE 1:"cod_depe2" = Código de dependencia 3 categorías (Municipal(0); Particular subvencionado(1); Particular pagado(2))

#VARIABLE 2: "cod_grupo" = Código de grupo socioeconómico (Bajo(0);Medio bajo(1);Medio(2);Medio alto(3);Alto(4))

#VARIABLE 3: "cdm_2017" = Categoría de Desempeño 2017 (INSUFICIENTE(0), MEDIO-BAJO(1), MEDIO(2) Y ALTO(3))
# Los establecimientos que tengan valores del Índice Final hasta el valor del percentil 12 (inclusive) de la distribución de este índice se clasificarán en la categoría Desempeño Insuficiente.
# Los establecimientos que presenten valores del Índice Final por sobre el valor del percentil 12 y hasta el percentil 35 (inclusive) se clasificarán en la categoría Desempeño Medio-Bajo.
# Los establecimientos que se sitúen por sobre el valor del percentil 35 y hasta el percentil 85 (inclusive) de la distribución del índice Final se clasificarán en la categoría Desempeño Medio.
# Los establecimientos con valores del Índice Final superiores al valor del percentil 85 de la distribución de este índice se clasificarán en la categoría Desempeño Alto.

load("~/Universidad/UAH 5° Semestre/OFC R para análisis estadístico/Trabajos/input/data-proc/simce2m2017_finalnum.RData")

dim(simce2m2017_finalnum)
frq(simce2m2017_finalnum)

#Recodificar la variable "cod_grupo" (Bajo, Medio, Alto)

simce2m2017_finalnum$cod_grupo <- car::recode(simce2m2017_finalnum$cod_grupo, "c(0,1)=0; c(2)=1; c(3,4)=2")

simce2m2017_finalnum$cod_grupo <- set_labels(simce2m2017_finalnum$cod_grupo,
                                  labels=c( "Bajo"=0,
                                            "Medio"=1,
                                            "Alto"=2))

frq(simce2m2017_finalnum$cod_grupo)

#Aplicar "as_factor".

simce2m2017_finalnum$cdm_2017 <- as_factor(simce2m2017_finalnum$cdm_2017)
simce2m2017_finalnum$cod_grupo <- as_factor(simce2m2017_finalnum$cod_grupo)
simce2m2017_finalnum$cod_depe2 <- as_factor(simce2m2017_finalnum$cod_depe2)

frq(simce2m2017_finalnum)

#Regresiones

reg1 <- lm(cod_grupo ~ 1, data=simce2m2017_finalnum)

stargazer(reg1, type="text")

#Intercepto de 2.681

#Regresion lineal simple

reg2 <- lm(cod_grupo ~ cod_depe2, data=simce2m2017_finalnum)
reg3 <- lm(cod_grupo ~ cdm_2017, data=simce2m2017_finalnum)

knitreg(list(reg2, reg3), 
        custom.model.names = c("Modelo 1",
                               "Modelo 2"),
        custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
        custom.coef.names = c("Intercepto", 
                              "Dependencia: Particular subvencionado",
                              "Dependencia: Particular pagado", 
                              "Desempeño: MEDIO-BAJO",
                              "Desempeño: MEDIO", 
                              "Desempeño: ALTO"),
        caption = "Grupo Socioeconómico",
        caption.above = TRUE)






































































































































































































