---
title: "Trabajo04"
author: "IgnaciaCS"
format: html
editor: visual
toc: true
link-citations: true
bibliography: Trabajo02.bib
link-bibliography: true
---

# Trabajo 04: R para Análisis Estadístico

## Regresión Lineal

## Por: Ignacia Castillo Soto

### **Mercantilización del sistema educativo y segregación escolar en Chile**

#### Introducción

###### (Trabajo 01)

Cómo se mencionó en la primera entrega[^1], la mercantilización del sistema educativo en el país comienza con las reformas neoliberales implementadas en dictadura, las cuales debilitaron el sistema educativo estatal promoviendo los fines de lucro y la competencia individual, a pesar de nuevas reformas, estas no han generado cambios sustanciales en las politicas educativas las cuales han llevado a una extrema privatización de la educación, la cual ha fomentado la segregación y desigualdad de oportunidades educativas en Chile.

[^1]: Informe teórico en [Trabajo01 (naxinii.github.io)](https://naxinii.github.io/Trabajos/Trabajo01.html)

La segregación escolar se refiere a la distribución desigual de los estudiantes en las escuelas según sus características socioeconómicas o culturales. En Chile, la segregación se evidencia tanto en la facultad que tienen los establecimientos para seleccionar estudiantes como en la libertad de elección de los padres, libertad teórica, ya que en la práctica, esta elección puede estar limitada por factores socioeconómicos y culturales, lo que lleva a la concentración de ciertos grupos en determinadas escuelas.

Las brechas educativas han aumentado debido a la naturaleza del sistema educacional actual, el cual reproduce las desigualdades preexistentes en el país. La idea principal de esta investigación se centra en cómo las prácticas de privatización han fomentado la segregación escolar, tomando los datos disponibles que entrega la Agencia de la Calidad de la Educación de la prueba SIMCE 2017 2° medio , seleccionando las variables que podrían reflejar mejor este fenómeno.

#### Análisis descriptivo

###### (Trabajo 02)

SIMCE es una evaluación cuyo objetivo es conocer los resultados educativos de los establecimientos, evaluando el logro de los contenidos y habilidades del Currículum Nacional, recogiendo información sobre el contexto educativo a través de cuestionarios que responden directores(as), docentes, estudiantes, padres, madres y apoderados, de modo de analizar los resultados en forma integral.

La segunda entrega de este curso[^2] contó con la generación de una nueva base de datos a partir de las bases originales del proceso SIMCE 2017 para los cursos de 2° medio a nivel país, junto a la selección, procesamiento y analisis descriptivo de las variables relevantes para el informe, las cuales son:

[^2]: Procesamiento y análisis completo en [Trabajo02 (naxinii.github.io)](https://naxinii.github.io/Trabajos/Trabajo02.html)

-   VARIABLE 1:"cod_depe2" = Código de dependencia 3 categorías (Municipal(1); Particular subvencionado(2); Particular pagado(3))

-   VARIABLE 2: "cod_grupo" = Código de grupo socioeconómico (Bajo(1);Medio bajo(2);Medio(3);Medio alto(4);Alto(5))

-   VARIABLE 3: "cdm_2017" = Categoría de Desempeño 2017 (INSUFICIENTE(1), MEDIO-BAJO(2), MEDIO(3) Y ALTO(4))

Se destacó que la mayoría de los establecimientos tienen un desempeño académico medio, seguido por un desempeño medio-bajo. En cuanto al tipo de establecimiento una gran mayoria son del tipo municipal subvencionado. En relación con el GSE más del 50% de establecimientos se encuentran entre el Medio y el Bajo. Se incluyen gráficos que muestran la distribución de las categorías de desempeño y del tipo de establecimiento. En el primer gráfico se observa una distribución desigual entre las categorías, destacando el desempeño medio como el más común. En el segundo gráfico, se destaca la minoría de colegios particulares pagados en comparación con los subvencionados.

```{r}
pacman::p_load(dplyr, 
               sjmisc, 
               car, 
               sjlabelled, 
               stargazer, 
               haven,
               kableExtra,
               sjPlot,
               summarytools,
               ggplot2)
rm(list=ls())       
options(scipen=999) 

load("~/Universidad/UAH 5° Semestre/OFC R para análisis estadístico/Trabajos/input/data-proc/simce2m2017_final.RData")

#| label: fig-cdm_2017
#| fig-cap: “Categorías de Desempeño”
graph1 <- simce2m2017_final %>% ggplot(aes(x = cdm_2017)) + 
  geom_bar(fill = "coral")+
  labs(title = "Categoría de Desempeño 2017",
       x = "Categoría de Desempeño",
       y = "Frecuencia") +
  theme_bw()

graph1
#| label: fig-cod_depe2
#| fig-cap:  “Código de Dependencia Establecimiento”
graph2 <- simce2m2017_final %>% ggplot(aes(x = cod_depe2)) + 
  geom_bar(fill = "green")+
  labs(title = "Código de Dependencia Establecimiento",
       x = "Codigo Dependencia",
       y = "Frecuencia") +
  theme_bw()

graph2
```

#### Asociación de variables y construcción de índices

###### (Trabajo 03)

#### Regresión Lineal

###### (Trabajo 04)

#### Parte 1. Carga de Librerías y preparación de datos

```{r}
pacman::p_load(dplyr, 
               car, 
               sjmisc, 
               sjPlot, 
               sjlabelled, 
               stargazer, 
               kableExtra, 
               corrplot, 
               texreg, 
               ggplot2, 
               ggpubr,
               summarytools,
               fastDummies, 
               ggeffects)

rm(list=ls())       
options(scipen=999)

#Carga de la base de datos

load("~/Universidad/UAH 5° Semestre/OFC R para análisis estadístico/Trabajos/input/data-proc/simce2m2017_finalnum.RData")

dim(simce2m2017_finalnum)
frq(simce2m2017_finalnum)
```

```{r}
#Recodificar la variable "cod_grupo" (Bajo, Medio, Alto) para reducir categorías

simce2m2017_finalnum$cod_grupo <- car::recode(simce2m2017_finalnum$cod_grupo, "c(0,1)=0; c(2)=1; c(3,4)=2")

simce2m2017_finalnum$cod_grupo <- set_labels(simce2m2017_finalnum$cod_grupo,
                                             labels=c( "Bajo"=0,
                                                       "Medio"=1,
                                                       "Alto"=2))

frq(simce2m2017_finalnum$cod_grupo)
```

```{r}
#Aplicar "as_factor" 

simce2m2017_finalnum$cod_grupo <- as_factor(simce2m2017_finalnum$cod_grupo)
simce2m2017_finalnum$cod_depe2 <- as_factor(simce2m2017_finalnum$cod_depe2)

frq(simce2m2017_finalnum)
```

#### Parte 2. Modelo de Regresión Lineal Simple

```{r}
reg1 <- lm(cdm_2017 ~ 1, data=simce2m2017_finalnum)

stargazer(reg1, type="text")
```

Intercepto es: 1.675\*\*\* (0.017)

Este modelo básico con solo la constante (intercepto) indica que el desempeño promedio de los establecimientos en el SIMCE 2017 es de aproximadamente 1.675 puntos. Sin embargo, el R cuadrado y el R cuadrado ajustado son ambos 0, lo que sugiere que el modelo no explica la variabilidad en el desempeño del establecimiento. El error estándar residual es de 0.878, lo que indica la dispersión de los datos alrededor de la línea de regresión.

```{r results='asis'}
reg2 <- lm(cdm_2017 ~ cod_depe2, data=simce2m2017_finalnum)
reg3 <- lm(cdm_2017 ~ cod_grupo, data=simce2m2017_finalnum)

knitreg(list(reg2, reg3), 
          custom.model.names = c("Modelo 1",
                                 "Modelo 2"),
          custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
          custom.coef.names = c("Intercepto", 
                                "Dependencia: Particular subvencionado <br> <i>(Ref. Dep.: Municipal)</i>",
                                "Dependencia: Particular pagado", 
                                "GSE: Medio <br> <i>(Ref. GSE: Bajo)</i>",
                                "GSE: Alto"),
          caption = "Desempeño del Establecimiento",
          caption.above = TRUE)
```

n este modelo de regresión simple, se evalúan dos variables independientes: la dependencia del establecimiento educativo (categorizada en particular subvencionado, particular pagado y municipal, siendo esta última la referencia) y el nivel socioeconómico de los estudiantes (categorizado en bajo, medio y alto, siendo bajo la referencia).

1.  **Dependencia del establecimiento**:

    -   Los establecimientos particulares subvencionados tienen un efecto positivo significativo en el desempeño del establecimiento en comparación con los municipales (coeficiente = 0.59, p \< 0.001).

    -   Los establecimientos particulares pagados tienen un efecto aún mayor en el desempeño (coeficiente = 0.98, p \< 0.001).

2.  **Nivel socioeconómico (GSE) de los estudiantes**:

    -   El nivel socioeconómico medio tiene un efecto positivo significativo en el desempeño del establecimiento en comparación con el nivel bajo (coeficiente = 0.61, p \< 0.001).

    -   El nivel socioeconómico alto tiene el efecto más significativo en el desempeño (coeficiente = 0.86, p \< 0.001).

En general, este modelo explica el 19% de la variabilidad en el desempeño del establecimiento, según el R cuadrado ajustado.

Este modelo sugiere que, en el contexto de Chile, la dependencia del establecimiento educativo (si es municipal, particular subvencionado o particular pagado) y el nivel socioeconómico de los estudiantes tienen un impacto significativo en el desempeño académico de los establecimientos.

1.  **Dependencia del establecimiento**:

    -   Los establecimientos particulares subvencionados y particulares pagados tienden a tener un desempeño académico superior en comparación con los municipales. Esto podría deberse a diferencias en recursos, infraestructura, o enfoques educativos entre los tipos de establecimientos.

    -   El mayor efecto se observa en los establecimientos particulares pagados, lo que sugiere que el financiamiento privado puede estar asociado con mejores resultados académicos.

2.  **Nivel socioeconómico de los estudiantes**:

    -   Los establecimientos con un mayor porcentaje de estudiantes en el nivel socioeconómico medio o alto tienden a tener un desempeño académico superior en comparación con aquellos con mayor proporción de estudiantes en el nivel bajo.

    -   Esto podría reflejar diferencias en el entorno familiar, acceso a recursos educativos adicionales, o apoyo académico fuera de la escuela que influyen en el rendimiento estudiantil.

En resumen, este modelo resalta la influencia significativa que factores como la dependencia del establecimiento y el nivel socioeconómico de los estudiantes tienen en el desempeño académico de los establecimientos educativos en Chile, lo que subraya la importancia de abordar las desigualdades en educación para mejorar la equidad y calidad educativa.

```{r}
plot_model(reg2, 
           title = "", 
           show.values = TRUE, 
           dot.size = 3, 
           line.size = 1, 
           value.size = 4, 
           spacing = 1, 
           vline.color = "red", 
           axis.labels = c("Municipal", 
                           "Particular subvencionado", 
                           "Particular pagado"), 
           show.legend = FALSE) + 
  theme_bw()
```

En este modelo (Modelo 2), la variable dependiente es el desempeño académico (cdm_2017) y la variable independiente es el nivel socioeconómico (GSE), donde se han creado dos variables ficticias para representar los niveles medio y alto, siendo el nivel bajo de referencia.

-   **Intercepto (1.30)**: El valor predicho de desempeño académico para un establecimiento ubicado en el nivel socioeconómico bajo (GSE: Bajo) es de aproximadamente 1.30. Esto significa que, en promedio, se espera que los establecimientos en el nivel socioeconómico bajo tengan un desempeño académico de 1.30 en la escala utilizada en el estudio.

-   **GSE: Medio (0.61)**: El valor predicho de desempeño académico para un establecimiento ubicado en el nivel socioeconómico medio es de aproximadamente 0.61 unidades más alto que para un establecimiento en el nivel socioeconómico bajo. Esto sugiere que, en promedio, se espera que los establecimientos en el nivel socioeconómico medio tengan un desempeño académico superior en 0.61 unidades en comparación con los del nivel bajo.

-   **GSE: Alto (0.86)**: El valor predicho de desempeño académico para un establecimiento ubicado en el nivel socioeconómico alto es de aproximadamente 0.86 unidades más alto que para un establecimiento en el nivel socioeconómico bajo. Esto sugiere que, en promedio, se espera que los establecimientos en el nivel socioeconómico alto tengan un desempeño académico superior en 0.86 unidades en comparación con los del nivel bajo.

En resumen, este modelo indica que, después de controlar otros factores, se espera que los establecimientos ubicados en niveles socioeconómicos medio y alto tengan un desempeño académico superior en comparación con los establecimientos en el nivel socioeconómico bajo, siendo este efecto mayor para los establecimientos en el nivel socioeconómico alto.

\-

Para interpretar los valores predichos en este modelo (Modelo 1), se debe tener en cuenta que la variable dependiente es el desempeño académico (cdm_2017) y la variable independiente es el tipo de dependencia del establecimiento (cod_depe2), donde el valor 1 corresponde a establecimientos municipales, el valor 2 a establecimientos particulares subvencionados y el valor 3 a establecimientos particulares pagados.

-   **Intercepto (1.20)**: El valor predicho de desempeño académico para un establecimiento municipal es de aproximadamente 1.20. Esto significa que, en promedio, se espera que los establecimientos municipales tengan un desempeño académico de 1.20 en la escala utilizada en el estudio.

-   **Dependencia: Particular subvencionado (0.59)**: El valor predicho de desempeño académico para un establecimiento particular subvencionado es de aproximadamente 0.59 unidades más alto que para un establecimiento municipal. Esto sugiere que, en promedio, se espera que los establecimientos particulares subvencionados tengan un desempeño académico superior en 0.59 unidades en comparación con los municipales.

-   **Dependencia: Particular pagado (0.98)**: El valor predicho de desempeño académico para un establecimiento particular pagado es de aproximadamente 0.98 unidades más alto que para un establecimiento municipal. Esto sugiere que, en promedio, se espera que los establecimientos particulares pagados tengan un desempeño académico superior en 0.98 unidades en comparación con los municipales.

En resumen, este modelo indica que, después de controlar otros factores, se espera que los establecimientos particulares subvencionados y particulares pagados tengan un desempeño académico superior en comparación con los municipales, siendo este efecto mayor para los establecimientos particulares pagados.

```{r}
plot_model(reg3, 
           title = "", 
           show.values = TRUE, 
           dot.size = 3, 
           line.size = 1, 
           value.size = 4, 
           spacing = 1, 
           vline.color = "blue", 
           axis.labels = c("Bajo", 
                           "Medio", 
                           "Alto"), 
           show.legend = FALSE) + 
  theme_bw()
```

**Modelo 1 (reg2):**

-   **Intercepto:** El desempeño promedio de los establecimientos municipales en el SIMCE 2017 es de aproximadamente 1.20 puntos.

-   **Dependencia: Particular subvencionado vs. Municipal:** Los establecimientos particulares subvencionados tienen un desempeño promedio 0.59 puntos mayor que los municipales, manteniendo constantes las demás variables en el modelo.

-   **Dependencia: Particular pagado vs. Municipal:** Los establecimientos particulares pagados tienen un desempeño promedio 0.98 puntos mayor que los municipales, manteniendo constantes las demás variables en el modelo.

-   **R2:** El modelo explica el 13% de la variabilidad en el desempeño del establecimiento.

**Modelo 2 (reg3):**

-   **Intercepto:** El desempeño promedio de los establecimientos del grupo socioeconómico (GSE) bajo en el SIMCE 2017 es de aproximadamente 1.30 puntos.

-   **GSE: Medio vs. Bajo:** Los establecimientos del GSE medio tienen un desempeño promedio 0.61 puntos mayor que los del GSE bajo, manteniendo constantes las demás variables en el modelo.

-   **GSE: Alto vs. Bajo:** Los establecimientos del GSE alto tienen un desempeño promedio 0.86 puntos mayor que los del GSE bajo, manteniendo constantes las demás variables en el modelo.

-   **R2:** El modelo explica el 19% de la variabilidad en el desempeño del establecimiento.

En resumen, los resultados sugieren que la dependencia administrativa y el nivel socioeconómico de los estudiantes están asociados significativamente con el desempeño académico de los establecimientos en el SIMCE 2017, con los establecimientos particulares (subvencionados y pagados) y los del GSE alto mostrando un mejor desempeño en comparación con los municipales y los del GSE bajo, respectivamente.

### Modelo 1:

-   **Intercepto**: El desempeño promedio de los establecimientos municipales (categoría de referencia) es de 1.20.

-   **Dependencia: Particular subvencionado**: En promedio, los establecimientos particulares subvencionados tienen un desempeño 0.59 puntos más alto que los municipales, manteniendo constante el efecto de las otras variables.

-   **Dependencia: Particular pagado**: En promedio, los establecimientos particulares pagados tienen un desempeño 0.98 puntos más alto que los municipales, manteniendo constante el efecto de las otras variables.

### Modelo 2:

-   **Intercepto**: El desempeño promedio de los establecimientos clasificados como "Bajo" en el grupo socioeconómico (GSE) es de 1.30.

-   **GSE: Medio**: En promedio, los establecimientos clasificados como "Medio" en el GSE tienen un desempeño 0.61 puntos más alto que los clasificados como "Bajo", manteniendo constante el efecto de las otras variables.

-   **GSE: Alto**: En promedio, los establecimientos clasificados como "Alto" en el GSE tienen un desempeño 0.86 puntos más alto que los clasificados como "Bajo", manteniendo constante el efecto de las otras variables.

Estas interpretaciones indican cómo cada variable independiente (dependencia y grupo socioeconómico) se relaciona con el desempeño educativo, considerando las demás variables constantes en el modelo.

Por ejemplo, una interpretación sustantiva de los resultados podría ser que, en promedio, los estudiantes de establecimientos particulares pagados tienden a tener un desempeño educativo significativamente superior en el SIMCE en comparación con los estudiantes de establecimientos municipales, incluso después de controlar otros factores. Otra interpretación podría ser que los estudiantes de nivel socioeconómico alto tienen un desempeño educativo notablemente mejor que los estudiantes de nivel socioeconómico bajo, independientemente de otros factores.

1.  **Modelo 1 (reg2):** Este modelo analiza la relación entre el tipo de dependencia de los establecimientos educativos (Municipal, Particular subvencionado, Particular pagado) y el desempeño educativo (cdm_2017).

    -   El intercepto (1.20) representa el desempeño promedio en la categoría de referencia, que en este caso es la dependencia municipal.

    -   El coeficiente para Particular subvencionado (0.59) indica que, en promedio, los establecimientos de esta categoría tienen un desempeño 0.59 puntos más alto que los municipales.

    -   El coeficiente para Particular pagado (0.98) indica que, en promedio, los establecimientos de esta categoría tienen un desempeño 0.98 puntos más alto que los municipales.

2.  **Modelo 2 (reg3):** Este modelo analiza la relación entre el grupo socioeconómico de los estudiantes (Bajo, Medio, Alto) y el desempeño educativo (cdm_2017).

    -   El intercepto (1.30) representa el desempeño promedio en la categoría de referencia, que en este caso es el grupo socioeconómico Bajo.

    -   El coeficiente para Medio (0.61) indica que, en promedio, los estudiantes de nivel socioeconómico Medio tienen un desempeño 0.61 puntos más alto que los estudiantes de nivel socioeconómico Bajo.

    -   El coeficiente para Alto (0.86) indica que, en promedio, los estudiantes de nivel socioeconómico Alto tienen un desempeño 0.86 puntos más alto que los estudiantes de nivel socioeconómico Bajo.

Estas interpretaciones sugieren que tanto el tipo de dependencia de los establecimientos educativos como el grupo socioeconómico de los estudiantes tienen un impacto significativo en el desempeño educativo, con diferencias importantes entre los distintos tipos de establecimientos y grupos socioeconómicos.

#### Parte 2.1 **Cálculo de Valores Predichos de un Coef. de Regresión**

```{r results='asis'}
reg2 <- lm(cdm_2017 ~ cod_depe2, data=simce2m2017_finalnum)
knitreg(list(reg2), 
        custom.model.names = c("Modelo 1"),
        custom.coef.names = c("Intercepto", 
                              "Dependencia: Particular subvencionado <br> <i>(Ref. Dep.: Municipal)</i>",
                              "Dependencia: Particular pagado"))
```

```{r}
#| label: fig-plot-reg2
#| fig-cap: "reg2"
ggeffects::ggpredict(reg2, terms = c("cod_depe2")) %>%
  ggplot(aes(x=x, y=predicted)) +
  geom_bar(stat="identity", color="grey", fill="grey")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width=.1) +
  labs(title="Código de Dependencia", x = "", y = "") +
  theme_bw() +
  scale_x_discrete(name = "",
                   labels = c("Municipal", 
                              "Particular subvencionado", 
                              "Particular pagado")) +
  scale_y_continuous(limits = c(0,16), 
                     breaks = seq(0,16, by = 1))
```

```{r results='asis'}
reg3 <- lm(cdm_2017 ~ cod_grupo, data=simce2m2017_finalnum)
knitreg(list(reg3), 
        custom.model.names = c("Modelo 2"),
        custom.coef.names = c("Intercepto", 
                              "GSE: Medio <br> <i>(Ref. GSE: Bajo)</i>",
                              "GSE: Alto"))
```

```{r}
#| label: fig-plot-reg3
#| fig-cap: "reg3"
ggeffects::ggpredict(reg3, terms = c("cod_grupo")) %>%
  ggplot(aes(x=x, y=predicted)) +
  geom_bar(stat="identity", color="pink", fill="pink")+
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width=.1) +
  labs(title="GSE", x = "", y = "") +
  theme_bw() +
  scale_x_discrete(name = "",
                   labels = c("Bajo", 
                              "Medio", 
                              "Alto")) +
  scale_y_continuous(limits = c(0,16), 
                     breaks = seq(0,16, by = 1))
```

#### Parte 3 Análisis e Interpretación

#### Conclusiones
